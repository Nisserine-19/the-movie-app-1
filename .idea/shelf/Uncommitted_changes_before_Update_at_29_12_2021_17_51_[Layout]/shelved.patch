Index: idbdata/src/main/java/com/gmail/eamosse/idbdata/datasources/OnlineDataSource.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.gmail.eamosse.idbdata.datasources\r\n\r\nimport com.gmail.eamosse.idbdata.api.response.* // ktlint-disable no-wildcard-imports\r\nimport com.gmail.eamosse.idbdata.api.response.CategoryResponse\r\nimport com.gmail.eamosse.idbdata.api.response.TokenResponse\r\nimport com.gmail.eamosse.idbdata.api.response.parse\r\nimport com.gmail.eamosse.idbdata.api.response.safeCall\r\nimport com.gmail.eamosse.idbdata.api.service.MovieService\r\nimport com.gmail.eamosse.idbdata.utils.Result\r\n\r\n/**\r\n * Manipule les données de l'application en utilisant un web service\r\n * Cette classe est interne au module, ne peut être initialisé ou exposé aux autres composants\r\n * de l'application\r\n */\r\ninternal class OnlineDataSource(private val service: MovieService) {\r\n\r\n    /**\r\n     * Récupérer le token du serveur\r\n     * @return [Result<Token>]\r\n     * Si [Result.Succes], tout s'est bien passé\r\n     * Sinon, une erreur est survenue\r\n     */\r\n\r\n    suspend fun getToken(): Result<TokenResponse> {\r\n        return safeCall {\r\n            val response = service.getToken()\r\n            response.parse()\r\n        }\r\n    }\r\n\r\n    suspend fun getCategories(): Result<List<CategoryResponse.Genre>> {\r\n        return try {\r\n            val response = service.getCategories()\r\n            if (response.isSuccessful) {\r\n                Result.Succes(response.body()!!.genres)\r\n            } else {\r\n                Result.Error(\r\n                    exception = Exception(),\r\n                    message = response.message(),\r\n                    code = response.code()\r\n                )\r\n            }\r\n        } catch (e: Exception) {\r\n            Result.Error(\r\n                exception = e,\r\n                message = e.message ?: \"No message\",\r\n                code = -1\r\n            )\r\n        }\r\n    }\r\n\r\n    suspend fun getMoviebyCategories(Id: String): Result<List<MoviesResponse.Movie>> {\r\n        return try {\r\n            val response = service.getMoviebyCategories(Id)\r\n            if (response.isSuccessful) {\r\n                Result.Succes(response.body()!!.results)\r\n            } else {\r\n                Result.Error(\r\n                    exception = Exception(),\r\n                    message = response.message(),\r\n                    code = response.code()\r\n                )\r\n            }\r\n        } catch (e: Exception) {\r\n            Result.Error(\r\n                exception = e,\r\n                message = e.message ?: \"No message\",\r\n                code = -1\r\n            )\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/idbdata/src/main/java/com/gmail/eamosse/idbdata/datasources/OnlineDataSource.kt b/idbdata/src/main/java/com/gmail/eamosse/idbdata/datasources/OnlineDataSource.kt
--- a/idbdata/src/main/java/com/gmail/eamosse/idbdata/datasources/OnlineDataSource.kt	(revision 93e3e0b4a869aa20d46c7e6cc1a1aaef898da833)
+++ b/idbdata/src/main/java/com/gmail/eamosse/idbdata/datasources/OnlineDataSource.kt	(date 1640736643215)
@@ -3,7 +3,6 @@
 import com.gmail.eamosse.idbdata.api.response.* // ktlint-disable no-wildcard-imports
 import com.gmail.eamosse.idbdata.api.response.CategoryResponse
 import com.gmail.eamosse.idbdata.api.response.TokenResponse
-import com.gmail.eamosse.idbdata.api.response.parse
 import com.gmail.eamosse.idbdata.api.response.safeCall
 import com.gmail.eamosse.idbdata.api.service.MovieService
 import com.gmail.eamosse.idbdata.utils.Result
Index: idbdata/src/main/java/com/gmail/eamosse/idbdata/api/service/MovieService.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.gmail.eamosse.idbdata.api.service\r\n\r\nimport com.gmail.eamosse.idbdata.api.response.CategoryResponse\r\nimport com.gmail.eamosse.idbdata.api.response.MoviesResponse\r\nimport com.gmail.eamosse.idbdata.api.response.TokenResponse\r\nimport retrofit2.Response\r\nimport retrofit2.http.GET\r\nimport retrofit2.http.Query\r\n\r\ninternal interface MovieService {\r\n    @GET(\"authentication/token/new\")\r\n    suspend fun getToken(): Response<TokenResponse>\r\n\r\n    @GET(\"genre/movie/list\")\r\n    suspend fun getCategories(): Response<CategoryResponse>\r\n\r\n    // ajouter\r\n    @GET(\"discover/movie\")\r\n    suspend fun getMoviebyCategories(@Query(\"with_genres\") Id: String): Response<MoviesResponse>\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/idbdata/src/main/java/com/gmail/eamosse/idbdata/api/service/MovieService.kt b/idbdata/src/main/java/com/gmail/eamosse/idbdata/api/service/MovieService.kt
--- a/idbdata/src/main/java/com/gmail/eamosse/idbdata/api/service/MovieService.kt	(revision 93e3e0b4a869aa20d46c7e6cc1a1aaef898da833)
+++ b/idbdata/src/main/java/com/gmail/eamosse/idbdata/api/service/MovieService.kt	(date 1640736643221)
@@ -15,6 +15,6 @@
     suspend fun getCategories(): Response<CategoryResponse>
 
     // ajouter
-    @GET("discover/movie")
+    @GET("discover/movie?")
     suspend fun getMoviebyCategories(@Query("with_genres") Id: String): Response<MoviesResponse>
 }
